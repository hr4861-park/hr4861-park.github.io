---
title: "단위 테스트를 작성하는 방법"
date: 2022-02-24T11:23:04Z
categories:
  - unit test
tags:
  - unit test
  - jest
  - typescript
  - mock
---


최근 회사 프로젝트에서 TDD를 통해 업무를 진행하고 있다. 지금까지 경험과 공부한 내용을 바탕으로 단위 테스트를 '나름대로 잘' 구성하기 위한 가이드를 작성합니다.

**예제 코드는 기본적으로 typescript 를 사용하며, 테스트 프레임워크는 Jest를 사용합니다.**


# AAA 패턴을 따르자.

AAA패턴은 테스트를 Arrange(준비), Act(실행), Assert(검증) 이라는 세 단계로 나누어 진행하는 방법입니다.
아래 sum함수는 숫자 두개를 입력받아 합을 계산하는 함수입니다.

```typescript
const sum = (num1: number, num2: number) => {
    return num1 + num2
};
```

위 함수의 동작을 검증하는 테스트 코드 AAA 패턴에 따라 작성 해 보겠습니다.

```typescript 
describe("'sum' 함수 테스트 스위트", () => {
  it('두 숫자를 입력받아 합을 반환합니다.', () => {
    // Arrange
    const first = 3;
    const second = 5;

    // Act
    const summary = sum(first, second);

    // Assert
    expect(summary).toEqual(8);
  });
});
```

- Arrange 단계에서는 테스트를 위한 의존성(위 예제에서는 first, second)을 준비합니다.
- Act 단계에서는 테스트 하고자 하는 함수를 의존성과 함께 호출하고, 그 결과값을 캡쳐합니다.
- Assert 단계에서는 결과를 검증합니다.



# 한개의 테스트에는 하나의 Act만 존재하도록 작성하자.

여러개의 Act가 존재한다는 것은 즉, 여러개의 동작단위를 검증하는 테스트를 의미합니다. 이러한 테스트는 단위테스트라고 보기 어렵고 오히려 통합 테스트에 가깝습니다. Act가 하나인 테스트는 간단하고, 빠르게 실행됩니다. 만약에 Act가 여러개인 테스트가 존재하다면 리팩토링을 통하여 각 Act를 각각의 테스트로 분리하는 것이 좋습니다.



# 테스트 내 분기문(if)을 사용하지 말자.

단위 테스트던 통합테스트던 테스트에 분기가 있어 좋은점은 단 하나도 없습니다. 오히려 테스트코드 자체가 복잡해져 유지보수측면에서 매우 불리합니다. 각각의 분기를 개별 테스트로 분리하는 것이 좋습니다.


